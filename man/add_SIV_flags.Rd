% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SerObj_Analysis_SIVScoring.R
\name{add_SIV_flags}
\alias{add_SIV_flags}
\title{Add SIV infection flags based on UCell score threshold}
\usage{
add_SIV_flags(serobj, score_col = "SIV_UCell", cutoff_quantile = 0.99)
}
\arguments{
\item{serobj}{A Seurat object containing per-cell metadata and the specified score column.}

\item{score_col}{Character. The metadata column name containing the numeric SIV-related score
(default: `"SIV_UCell"`).}

\item{cutoff_quantile}{Numeric between 0 and 1. The quantile of the score distribution used
as the positivity threshold (default: `0.99` for 99th percentile).}
}
\value{
A Seurat object with two additions:
  \itemize{
    \item A new logical column `SIV_Positive` in the metadata, indicating cells above threshold.
    \item The computed numeric threshold stored in `serobj@misc$SIV_threshold`.
  }
}
\description{
This function computes a percentile-based threshold on the SIV-associated UCell score
(or any continuous infection-related score) and annotates cells as SIV-positive
if they exceed that threshold. The cutoff is stored in the Seurat object's
metadata and also recorded in the `@misc` slot for reference.
}
\details{
This function is designed for CosMx or other spatial transcriptomic datasets
where a custom SIV gene signature (e.g., gag, pol, env) is quantified per cell.
The percentile cutoff can be tuned depending on the noise characteristics of
each slide or experimental condition.
}
\examples{
serobj <- add_SIV_flags(serobj, score_col = "SIV_UCell", cutoff_quantile = 0.99)
head(serobj@meta.data$SIV_Positive)

}
