% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SerObj_Analysis_SIVScoring.R
\name{plot_SIV_histogram}
\alias{plot_SIV_histogram}
\title{Plot histogram of SIV-associated score with cutoff annotation}
\usage{
plot_SIV_histogram(
  serobj,
  score_col = "SIV_UCell",
  palette = c("white", "grey", "lightblue", "gold", "red"),
  cutoff = NULL
)
}
\arguments{
\item{serobj}{A Seurat object containing the specified score column in its metadata.
The threshold value is optionally retrieved from `serobj@misc$SIV_threshold`.}

\item{score_col}{Character. The metadata column containing the numeric SIV-related
score to visualize (default: `"SIV_UCell"`).}

\item{palette}{Character vector specifying the color gradient used to fill histogram
bars (default: `c("white", "grey", "lightblue", "gold", "red")`).}

\item{cutoff}{Numeric. Optional score threshold value to display as a dashed
vertical line. If `NULL`, the function automatically uses the threshold stored
in `serobj@misc$SIV_threshold`.}
}
\value{
A `ggplot2` object showing the histogram of the score distribution with
  the selected threshold annotated.
}
\description{
Creates a histogram showing the distribution of an SIV-related score (for example,
UCell score) across all cells, using the same color palette as the spatial plots.
The chosen threshold (usually the 95th or 99th percentile) is indicated by a dashed
vertical line and labeled directly on the plot.
}
\details{
This plot is typically used alongside `plot_spatial_SIV()` to visualize how the
chosen threshold partitions the population into SIV-positive and SIV-negative cells.
The color palette matches that used in spatial plots to ensure visual consistency.
}
\examples{
p_hist <- plot_SIV_histogram(serobj,
                             score_col = "SIV_UCell",
                             palette = c("white", "grey", "lightblue", "gold", "red"),
                             cutoff = serobj@misc$SIV_threshold)
print(p_hist)

}
