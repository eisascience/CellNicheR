% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SerObj_Analysis_SIVScoring.R
\name{summarize_SIV_by_celltype}
\alias{summarize_SIV_by_celltype}
\title{Summarize and visualize SIV-positive cells by cell type}
\usage{
summarize_SIV_by_celltype(
  serobj,
  celltype_col,
  flag_col = "SIV_Positive",
  label_percent = TRUE,
  label_title = "SIV+"
)
}
\arguments{
\item{serobj}{A Seurat object containing per-cell metadata, including a cell type
annotation column and a logical flag column (for example, `SIV_Positive` or
`SIV_Plausible`).}

\item{celltype_col}{Character. The metadata column containing cell type labels.}

\item{flag_col}{Character. The metadata column indicating SIV-positive cells
(default: `"SIV_Positive"`).}

\item{label_percent}{Logical. Whether to annotate bars with the percentage of
positive cells (default: `TRUE`).}

\item{label_title}{Character. Legend title for the positive flag
(default: `"SIV+"`).}
}
\value{
A `ggplot2` object showing the proportion of SIV-positive cells within
  each annotated cell type. Cell types are ordered by decreasing proportion
  of positives.
}
\description{
Generates a bar plot summarizing the fraction (or count) of SIV-positive cells
across annotated cell types. The plot can optionally display percentage labels
on each bar, showing the proportion of positive cells within each cell type.
}
\details{
This function computes, for each cell type, the proportion of cells that are
positive according to the specified logical flag column. It is useful for
identifying which cell types are most enriched for viral signal. When used
with `SIV_Plausible`, the plot highlights biologically plausible infection
patterns across permissive cell types.
}
\examples{
# Summarize all SIV-positive cells by cell type
p_summary_all <- summarize_SIV_by_celltype(
  serobj,
  celltype_col = "RNA_Pre.Napari.v3.0.071825_Cell.Typing.InSituType.2_1_clusters",
  flag_col = "SIV_Positive"
)

# Summarize only biologically plausible SIV-positive cells
p_summary_plaus <- summarize_SIV_by_celltype(
  serobj,
  celltype_col = "RNA_Pre.Napari.v3.0.071825_Cell.Typing.InSituType.2_1_clusters",
  flag_col = "SIV_Plausible",
  label_title = "Plausible SIV+"
)

}
