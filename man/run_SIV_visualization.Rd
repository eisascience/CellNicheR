% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SerObj_Analysis_SIVScoring.R
\name{run_SIV_visualization}
\alias{run_SIV_visualization}
\title{Generate combined spatial and summary visualization of SIV infection}
\usage{
run_SIV_visualization(
  serobj,
  celltype_col,
  susceptible_types,
  cutoff_quantile = 0.99
)
}
\arguments{
\item{serobj}{A Seurat object containing spatial metadata (`x_slide_mm`,
`y_slide_mm`) and an SIV-related score column (for example, `SIV_UCell`).}

\item{celltype_col}{Character. The metadata column specifying per-cell type
annotations used to stratify SIV-positive counts.}

\item{susceptible_types}{Character vector of biologically plausible
SIV-permissive cell types (for example, `"T.cell.CD4"`, `"Macrophage"`,
`"Monocyte"`, `"Conventional.dendritic.cell"`).}

\item{cutoff_quantile}{Numeric between 0 and 1. Quantile used to determine the
threshold for SIV positivity (default: `0.99` for 99th percentile).}
}
\value{
A `patchwork` composite object combining six panels:
  \itemize{
    \item Top row:
      \enumerate{
        \item Continuous SIV score spatial map (`plot_spatial_SIV`)
        \item Histogram of SIV score with threshold (`plot_SIV_histogram`)
        \item Binary SIV+ vs others map (`plot_spatial_binary`)
      }
    \item Bottom row:
      \enumerate{
        \item Spatial map of biologically plausible SIV+ cells (`plot_spatial_plausible`)
        \item Bar plot of SIV+ fraction by cell type (`summarize_SIV_by_celltype`)
        \item Bar plot of plausible SIV+ fraction by cell type (`summarize_SIV_by_celltype`)
      }
  }
}
\description{
Creates a composite figure integrating spatial, histogram, and cell-type
summary plots for SIV-associated signals within a Seurat object. This function
applies the full analysis pipeline: thresholding based on SIV score,
filtering for biologically plausible infection targets, and visualizing
both spatial distributions and per-cell-type summaries.
}
\details{
This high-level function runs the full visualization workflow for a given
CosMx-derived Seurat object. It performs thresholding (via `add_SIV_flags`),
filters plausible infected cell types (`add_SIV_plausible`), and combines
outputs from all lower-level plotting functions into a single summary figure.
The output can be saved directly using `ggsave()` for slide- or sample-level reports.
}
\examples{
combined_plot <- run_SIV_visualization(
  serobj = SerObjLS$PerLN_34100_LN1,
  celltype_col = "RNA_Pre.Napari.v3.0.071825_Cell.Typing.InSituType.2_1_clusters",
  susceptible_types = c("T.cell.CD4", "T.cell.regulatory",
                        "Macrophage", "Monocyte",
                        "Conventional.dendritic.cell",
                        "Plasmacytoid.dendritic.cell"),
  cutoff_quantile = 0.99
)
print(combined_plot)

}
