% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Support_Analysis_SIVScoring.R
\name{select_hotspot_seeds}
\alias{select_hotspot_seeds}
\title{Select Non-Overlapping Hotspot Seed Centers}
\usage{
select_hotspot_seeds(
  meta,
  score_col,
  flag_col,
  r_mm,
  max_seeds = Inf,
  min_sep = NULL,
  verbose = FALSE
)
}
\arguments{
\item{meta}{A data frame of per-cell metadata containing spatial coordinates
and scoring information. Must include:
\describe{
  \item{\code{x_slide_mm}}{Numeric x-coordinate (in mm).}
  \item{\code{y_slide_mm}}{Numeric y-coordinate (in mm).}
}}

\item{score_col}{Character string specifying the column name containing the
numeric score used to rank potential seeds (e.g., \code{"SIV_UCell"}).}

\item{flag_col}{Character string specifying the logical column indicating
which cells are eligible to be considered as seeds (e.g., \code{"SIV_Plausible"}).}

\item{r_mm}{Numeric. Base spatial scale (in mm) used for ROI construction; also
serves as the default for \code{min_sep} if not explicitly provided.}

\item{max_seeds}{Integer. Maximum number of seeds to select (default: \code{Inf}).}

\item{min_sep}{Numeric. Minimum allowed Euclidean distance (in mm) between
two selected seeds (default: \code{r_mm}).}

\item{verbose}{Logical. If \code{TRUE}, prints per-iteration diagnostic output
showing seed coordinates and current distance thresholds (default: \code{FALSE}).}
}
\value{
A data frame of selected seed cells (subset of \code{meta}) containing
  all original metadata columns for each chosen seed. The number of returned rows
  corresponds to the number of independent hotspots identified.
}
\description{
Identifies spatially separated seed points (typically SIV-plausible cells)
used to define regions of interest (ROIs). The function ranks candidate cells
by a scoring column (e.g., infection score), then iteratively selects the
highest-scoring cells while enforcing a minimum spatial separation between
chosen seeds.
}
\details{
The algorithm proceeds as follows:
\enumerate{
  \item Filter candidate cells where \code{flag_col == TRUE}.
  \item Sort candidates in descending order of \code{score_col}.
  \item Iteratively select the highest-scoring cell, then remove all remaining
        candidates within \code{min_sep} of that seed.
}

This ensures a spatially thinned set of non-overlapping hotspots, suitable for
defining independent ROI centers.

The function uses a soft exclusion criterion (\code{0.9 * min_sep}) to prevent
over-thinning in dense areas, balancing independence with coverage.
}
\examples{
meta <- data.frame(
  x_slide_mm = runif(1000, 0, 2),
  y_slide_mm = runif(1000, 0, 2),
  SIV_UCell = runif(1000),
  SIV_Plausible = sample(c(TRUE, FALSE), 1000, TRUE)
)
seeds <- select_hotspot_seeds(meta, score_col = "SIV_UCell",
                              flag_col = "SIV_Plausible",
                              r_mm = 0.05)
head(seeds)

}
\seealso{
\code{\link{build_rois_fast}} and \code{\link{make_control_centers}} for
downstream ROI generation, and \code{\link{summarize_rois}} for ROI summarization.
}
